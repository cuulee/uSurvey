{% extends "layout.html" %}
{% block title %}
  {{ model.verbose_name }}
{% endblock %}
{% block content %}
{% load pagination_tags %}
{% autopaginate question_sets 50 %}
{% load template_tags %}
<div class="row">
<div id="" class="dataTables_filter"><button class="btn btn-white btn-warning btn-bold">
												<i class="ace-icon fa fa-plus bigger-120 orange"></i>
<a href="#new_question_set" data-toggle="modal"  class="btn btn_primary pull-right padded-bottom" id="add_question_set">Create New {{ model.verbose_name }}</a>
											</button></div>
{% include "search_form.html" %}
</div>
 <br />
  <table class="table table-striped table-bordered table-hover table-sort">
    <thead>
      <tr>
        <th>
          Name
        </th>
        <th class="span6">
          Description
        </th>
        {% if model.verbose_name == 'Listing Form' %}
        <th>
          No. Of Surveys
        </th>
        <th>
          Total Interviews
        </th>
        {% endif %}
        <th  style="background-image: None;">
          Actions
        </th>
      </tr>
    </thead>
    <tbody>
      {% for question_set in question_sets %}
        <tr>
          <td>
             <a href="{% url 'qset_questions_page' question_set.id %}">{{ question_set.name }}</a>
          </td>
          <td>
            {{ question_set.description }}
          </td>
          {% if model.verbose_name == 'Listing Form' %}
          <td>
              {{ question_set.surveys.count }}
          </td>
          <td>
              {{ question_set.interviews.count}}
          </td>
          {% endif %}
          <td>
            <div class="btn-group">
                <a class="btn btn-small" href='{% url "edit_"|add:model.resolve_tag|add:"_page" question_set.id %}'><i class="icon-pencil"></i> Edit</a>
                {% if not question_set.interviews.exists %}
                <a class="btn btn-small " data-toggle="modal" href="#delete_questionset_{{question_set.id}}"><i class="icon-trash"></i> Delete</a>
                {% include "base/delete_modal.html" with object_name=question_set.name id=question_set.id name=question_set.verbose_name url=question_set.id|get_url_with_ids:"delete_qset" %}
                {% endif %}
                <a class="add_batch btn btn-small" href="{% url 'qset_questions_page' question_set.pk %}">View/Edit Questions</a>
                {% if question_set.interviews.count %}
                <a class="add_batch btn btn-small" href="{% url 'set_questions_index_page' question_set.pk %}">View Data</a>
                {% endif %}
                {% if question_set.verbose_name = 'Batch' and question_set.flow_questions %}
                    <a class="btn btn-small" href="{% url 'batch_show_page' question_set.survey.id question_set.pk %}"><i class="icon-lock"></i> Open/Close</a>
                {% endif %}
                {% comment %}
                {% if question_set.verbose_name == 'Listing Form' %}
                    <a class="add_batch btn btn-small" href="{% url 'sampling_criteria' question_set.pk %}">Sampling Criteria</a>
                {% endif %}
                {% endcomment %}

            </div>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
    <div class="modal fade hide" id="new_question_set" tabindex="-1" role="dialog"  aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">New {{ model.verbose_name.capitalize }}</h4>
              </div>
              <div class="modal-body">
                {% if model.verbose_name == 'Batch' %}
                    {% include "question_set/inline_new.html" with title="" model=model action=survey.id|get_url_with_ids:"new_batch_page"  button_label="Save"%}
                {% else %}
                    {% include "question_set/inline_new.html" with title="" model=model action="new_"|add:model.resolve_tag|add:"_page"|get_url_without_ids  button_label="Save"%}
                {% endif %}
              </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->

  {% paginate %}
{% endblock %}


{% block javascripts %}
    <script src="{{STATIC_URL}}js/survey.js" type="text/javascript" charset="utf-8"></script>
{% endblock %}
