{% extends "layout.html" %}
{% block title %}
  {% if model.verbose_name == 'Batch' %}
        {{ survey }} Batches
  {% else %}
  {{ model.verbose_name }}
  {% endif %}
{% endblock %}
{% block search %}
{% include "search_form.html" %}
{% endblock %}
{% block page_actions %}
  <!--   <button class="btn btn-white btn-warning btn-bold">
												<i class="ace-icon fa fa-plus bigger-120 orange"></i>
												<a href="#new_question_set" data-toggle="modal"  class="" id="add_question_set">Create New {{ model.verbose_name }}</a>
											</button> -->

    <button class="btn btn-white btn-warning btn-bold" data-toggle="modal" data-target="#new_question_set"  id="add_question_set">
          <i class="ace-icon fa fa-plus bigger-120 orange"></i>
                        Create New {{ model.verbose_name }} 
                      </button>

{% endblock %}
{% block content %}
{% load pagination_tags %}
{% autopaginate question_sets 50 %}
{% load template_tags %}

</div>
 <br />
  <table id="" class="table table-striped table-bordered table-hover dataTable no-footer" role="grid" aria-describedby="dynamic-table_info">
    <thead>
      <tr>
        <th class="sorting">
          Name
        </th>
        <th class="sorting">
          Description
        </th>
        {% if model.verbose_name == 'Listing Form' %}
        <th class="sorting">
          No. Of Surveys
        </th>
        <th class="sorting">
          Total Interviews
        </th>
        {% endif %}
        <th>
          Actions
        </th>
      </tr>
    </thead>
    <tbody>
      {% for question_set in question_sets %}
        <tr>
          <td>
             <a href="{% url 'qset_questions_page' question_set.id %}">{{ question_set.name }}</a>
          </td>
          <td>
            {{ question_set.description }}
          </td>
          {% if model.verbose_name == 'Listing Form' %}
          <td>
              {{ question_set.surveys.count }}
          </td>
          <td>
              {{ question_set.interviews.count}}
          </td>
          {% endif %}
          <td>
            <div class="">
                <div class="inline pos-rel">
                       <button class="btn btn-minier btn-yellow dropdown-toggle" data-toggle="dropdown" data-position="auto">
                           <i class="usur-icon fa fa-caret-down icon-only bigger-120"></i>
                       </button>
                        <ul class="dropdown-menu dropdown-only-icon dropdown-yellow dropdown-menu-right dropdown-caret dropdown-close">
                            <li>
                                <a href='{% url "edit_"|add:model.resolve_tag|add:"_page" question_set.id %}' class="tooltip-info" data-rel="tooltip" title="" data-original-title="Edit"><span class="blue"><i class="usur-icon fa fa-pencil-square-o bigger-120"></i>Edit</span></a>
                            </li>
                            {% if not question_set.interviews.exists %}
                            <li><a href="#" data-target="#delete_question_set_{{question_set.id}}" data-toggle="modal"><span class="green"><i class="usur-icon fa fa-trash bigger-120"></i>Delete</span></a></li>
                            {% include "base/delete_modal.html" with object_name=question_set.name id=question_set.id name="question_set" url=question_set.id|get_url_with_ids:"delete_qset" %}
                            {% endif %}
                            <li>
                                <a href="{% url 'qset_questions_page' question_set.pk %}" class="tooltip-info" data-rel="tooltip" title="" data-original-title="Edit"><span class="blue"><i class="usur-icon fa fa-question-circle bigger-120"></i>View/Edit Questions</span></a>
                            </li>
                            {% if question_set.interviews.count %}
                            <li><a href="{% url 'set_questions_index_page' question_set.pk %}" class="tooltip-error" data-rel="tooltip" title=""><span class="red"><i class="usur-icon fa fa-table bigger-120"></i>View Data</span></a></li>
                            {% endif %}
                            {% if question_set.verbose_name = 'Batch' and question_set.flow_questions %}
                            <li><a href="{% url 'batch_show_page' question_set.survey.id question_set.pk %}" class="tooltip-error" data-rel="tooltip" title=""><span class="red"><i class="usur-icon a fa-folder-open-o/fa fa-times-circle bigger-120"></i>Open/Close</span></a></li>
                            {% endif %}
                        </ul>
                </div>
            </div>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
    <div class="modal fade" id="new_question_set" tabindex="-1" role="dialog"  aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header" style="background-color: #3498DB;border-top: 1px solid #70B6E5;border-bottom: 5px solid #2372A7;" >
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">New {{ model.verbose_name.capitalize }}</h4>
              </div>
              <div class="modal-body">
                {% if model.verbose_name == 'Batch' %}
                    {% include "question_set/inline_new.html" with title="" model=model action=survey.id|get_url_with_ids:"new_batch_page"  button_label="Save"%}
                {% else %}
                    {% include "question_set/inline_new.html" with title="" model=model action="new_"|add:model.resolve_tag|add:"_page"|get_url_without_ids  button_label="Save"%}
                {% endif %}
              </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->

  {% paginate %}
{% endblock %}


{% block javascripts %}
    <script src="{{STATIC_URL}}js/survey.js" type="text/javascript" charset="utf-8"></script>
{% endblock %}
